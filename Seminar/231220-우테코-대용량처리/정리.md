# 대용량 처리

## 느슨한 시스템 구조
각 시스템간에는 큐를 통해서 연동 진행. 
- 느슨한 결합을 유지. 
- 문제가 생겨도 장애가 전파되지 않도록.

![image](/Seminar/231220-우테코-대용량처리/image/시스템연동.png)

## 조회 성능 개선
30일의 데이터만 유지한다. 
- 30일이 지나면 정책적으로 주문 상태 변경을 막는다. 
- 즉, 30일이 지난 데이터는 수정 가능성이 없는 스냅샷 개념의 데이터이다. 

조회를 위한 조회 모델을 사용한다. 조회 모델은 mongodb를 이용한다. 
- 이를 통해서 기존에 left join을 통해서 애그리거트를 조회하는 부분에 대한 개선을 만들어냈다. 

몇가지 DB를 목적에 맞게 사용한다. 
1. RDBMS
2. MongoDB: 조회 성능 개선
3. ElasticSearch: 주문 내역 조회 등에 사용

![image](/Seminar/231220-우테코-대용량처리/image/주문처리.png)

ZeroPayload 사용
![image](/Seminar/231220-우테코-대용량처리/image/ZeroPayload.png)

## 쓰기 성능 개선
샤딩을 이용해서 쓰기 분산 처리. 
- aurora는 샤딩을 지원하지 않아서, 애플리케이션에서 샤딩 구현

## 서비스 배포 시, 영향도를 줄이기 위한 노력
Toggle 개념을 적용해서 서버를 재시작 하지 않아도 변경 사항을 롤백 할 수 있는 방법 구현. 

A/B 테스팅 플랫폼을 이용해서 일정 범위의 사용자에 대해서만 신규 기능 적용.

## 시도해 볼 내용
데이터 수명 주기 설정
- 30일이 지난 데이터에 대해서 수명 설정을 하자. 

30일이 지난 데이터
- 별도로 데이터를 마이그레이션해서 여기를 바라보게 하자. 

MongoDB, Elastic Search 공부

